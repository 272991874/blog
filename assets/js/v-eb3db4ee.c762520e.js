"use strict";(self.webpackChunkyaomin=self.webpackChunkyaomin||[]).push([[1386],{8209:(n,e,s)=>{s.r(e),s.d(e,{data:()=>a});const a={key:"v-eb3db4ee",path:"/soft/nginx_tcp.html",title:"Nginx 通过域名代理tcp",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"1.需要 stream 模块",slug:"_1-需要-stream-模块",children:[]},{level:2,title:"2.stream 是一个单独的模块",slug:"_2-stream-是一个单独的模块",children:[]},{level:2,title:"修改nginx.conf，添加如下配置即可",slug:"修改nginx-conf-添加如下配置即可",children:[]}],filePathRelative:"soft/nginx_tcp.md",git:{contributors:[{name:"yaomin",email:"272991874@qq.com",commits:1}]}}},7156:(n,e,s)=>{s.r(e),s.d(e,{default:()=>m});var a=s(6252);const r=(0,a._)("h1",{id:"nginx-通过域名代理tcp",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#nginx-通过域名代理tcp","aria-hidden":"true"},"#"),(0,a.Uk)(" Nginx 通过域名代理tcp")],-1),l={class:"table-of-contents"},t=(0,a.Uk)("1.需要 stream 模块"),i=(0,a.Uk)("2.stream 是一个单独的模块"),p=(0,a.Uk)("修改nginx.conf，添加如下配置即可"),c=(0,a.uE)('<h2 id="_1-需要-stream-模块" tabindex="-1"><a class="header-anchor" href="#_1-需要-stream-模块" aria-hidden="true">#</a> 1.需要 stream 模块</h2><p>nginx 添加stream 模块即可</p><h2 id="_2-stream-是一个单独的模块" tabindex="-1"><a class="header-anchor" href="#_2-stream-是一个单独的模块" aria-hidden="true">#</a> 2.stream 是一个单独的模块</h2><p>不需要放在nginx-http配置中，放在nginx.conf最后即可</p><h2 id="修改nginx-conf-添加如下配置即可" tabindex="-1"><a class="header-anchor" href="#修改nginx-conf-添加如下配置即可" aria-hidden="true">#</a> 修改nginx.conf，添加如下配置即可</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>stream {\n    map $ssl_preread_server_name $name {\n        mysql.test.com mysql;\n        redis.test.com redis;\n        default https_default_backend;\n    }\n    upstream mysql{\n        server 10.0.0.3:3306;\n    }\n    upstream redis{\n        server 10.0.0.4:6379;\n    }\n    upstream https_default_backend {\n        server 127.0.0.1:443;\n    }\n    server {\n        listen 10.0.0.1:443;\n        proxy_pass $name;\n        ssl_preread on;\n    }\n}\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>需要把map中参数变成域名</p>',7),m={render:function(n,e){const s=(0,a.up)("RouterLink");return(0,a.wg)(),(0,a.iD)(a.HY,null,[r,(0,a._)("nav",l,[(0,a._)("ul",null,[(0,a._)("li",null,[(0,a.Wm)(s,{to:"#_1-需要-stream-模块"},{default:(0,a.w5)((()=>[t])),_:1})]),(0,a._)("li",null,[(0,a.Wm)(s,{to:"#_2-stream-是一个单独的模块"},{default:(0,a.w5)((()=>[i])),_:1})]),(0,a._)("li",null,[(0,a.Wm)(s,{to:"#修改nginx-conf-添加如下配置即可"},{default:(0,a.w5)((()=>[p])),_:1})])])]),c],64)}}}}]);