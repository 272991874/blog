<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.24">
    <link rel="icon" href="/images/photo.png"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" href="/images/photo.png"><meta name="baidu-site-verification" content="code-R2J22eW56T"><meta name="keywords" content="yaomin,yaomin_java,java,linux,aihhy.cn,aihhy,海会云"><script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e96e34849c698b37da0a83d87dc232de";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script><script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script><title>spring base循环依赖 | Min Yao</title><meta name="description" content="JAVA:一切皆对象 OS:一切皆文件 CPU:一切皆01">
    <link rel="preload" href="/blog/assets/js/runtime~app.c2b0329d.js" as="script"><link rel="preload" href="/blog/assets/css/styles.ee6644aa.css" as="style"><link rel="preload" href="/blog/assets/js/1812.cd766a42.js" as="script"><link rel="preload" href="/blog/assets/js/app.f50a6895.js" as="script">
    <link rel="stylesheet" href="/blog/assets/css/styles.ee6644aa.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><img class="logo" src="/blog/images/photo.png" alt="Min Yao"><span class="site-name can-hide">Min Yao</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/blog/algorithm/" class="nav-link" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/dataStructure/" class="nav-link" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程"><span class="title">编程</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="编程"><span class="title">编程</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/programming/" class="nav-link" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/java/" class="nav-link router-link-active" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/groovy/" class="nav-link" aria-label="Groovy"><!--[--><!--]--> Groovy <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/golang/" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/blog/lot/" class="nav-link" aria-label="物联网"><!--[--><!--]--> 物联网 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/web/" class="nav-link" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/soft/" class="nav-link" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/manage/" class="nav-link" aria-label="管理"><!--[--><!--]--> 管理 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="高级"><span class="title">高级</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="高级"><span class="title">高级</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/blog/framework/" class="nav-link" aria-label="架构"><!--[--><!--]--> 架构 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/blog/others/" class="nav-link" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://www.google.com/" rel="noopener noreferrer" target="_blank" aria-label="Google"><!--[--><!--]--> Google <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://stackoverflow.com/questions" rel="noopener noreferrer" target="_blank" aria-label="stackoverflow"><!--[--><!--]--> stackoverflow <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://gitee.com/yaomin_java/yaomin.git" rel="noopener noreferrer" target="_blank" aria-label="Gitee"><!--[--><!--]--> Gitee <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/blog/algorithm/" class="nav-link" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/dataStructure/" class="nav-link" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程"><span class="title">编程</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="编程"><span class="title">编程</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/programming/" class="nav-link" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/java/" class="nav-link router-link-active" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/groovy/" class="nav-link" aria-label="Groovy"><!--[--><!--]--> Groovy <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/golang/" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/blog/lot/" class="nav-link" aria-label="物联网"><!--[--><!--]--> 物联网 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/web/" class="nav-link" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/soft/" class="nav-link" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/manage/" class="nav-link" aria-label="管理"><!--[--><!--]--> 管理 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="高级"><span class="title">高级</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="高级"><span class="title">高级</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/blog/framework/" class="nav-link" aria-label="架构"><!--[--><!--]--> 架构 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/blog/others/" class="nav-link" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://www.google.com/" rel="noopener noreferrer" target="_blank" aria-label="Google"><!--[--><!--]--> Google <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://stackoverflow.com/questions" rel="noopener noreferrer" target="_blank" aria-label="stackoverflow"><!--[--><!--]--> stackoverflow <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://gitee.com/yaomin_java/yaomin.git" rel="noopener noreferrer" target="_blank" aria-label="Gitee"><!--[--><!--]--> Gitee <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">java文章</p><ul class=""><li><!--[--><a href="/blog/java/java.html" class="nav-link sidebar-item" aria-label="Java基础"><!--[--><!--]--> Java基础 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_string.html" class="nav-link sidebar-item" aria-label="String 属于基础的数据类型吗？"><!--[--><!--]--> String 属于基础的数据类型吗？ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_final.html" class="nav-link sidebar-item" aria-label="final 在 java 中的作用"><!--[--><!--]--> final 在 java 中的作用 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_hashcode.html" class="nav-link sidebar-item" aria-label="两个对象的 hashCode()相同，则 equals()也一定为 true，对吗？"><!--[--><!--]--> 两个对象的 hashCode()相同，则 equals()也一定为 true，对吗？ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_equals.html" class="nav-link sidebar-item" aria-label="equals和== 的区别是什么?"><!--[--><!--]--> equals和== 的区别是什么? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_math.html" class="nav-link sidebar-item" aria-label="java 中的 Math.round(-1.5) 等于多少?"><!--[--><!--]--> java 中的 Math.round(-1.5) 等于多少? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_property.html" class="nav-link sidebar-item" aria-label="System.getProperty(String key)"><!--[--><!--]--> System.getProperty(String key) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_jvm_option.html" class="nav-link sidebar-item" aria-label="JVM调优常用参数"><!--[--><!--]--> JVM调优常用参数 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_jvm.html" class="nav-link sidebar-item" aria-label="JVM"><!--[--><!--]--> JVM <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_jvm_tuning.html" class="nav-link sidebar-item" aria-label="jvm调优"><!--[--><!--]--> jvm调优 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_thread_base.html" class="nav-link sidebar-item" aria-label="多线程"><!--[--><!--]--> 多线程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_ThreadPoolExecutor.html" class="nav-link sidebar-item" aria-label="ThreadPoolExecutor"><!--[--><!--]--> ThreadPoolExecutor <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_volatile.html" class="nav-link sidebar-item" aria-label="volatile关键字"><!--[--><!--]--> volatile关键字 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_ClassLoader.html" class="nav-link sidebar-item" aria-label="ClassLoader类加载器"><!--[--><!--]--> ClassLoader类加载器 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_btrace_arthas.html" class="nav-link sidebar-item" aria-label="Btrace &amp; Arthas"><!--[--><!--]--> Btrace &amp; Arthas <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_extend_implements.html" class="nav-link sidebar-item" aria-label="继承 和 实现"><!--[--><!--]--> 继承 和 实现 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_up_down.html" class="nav-link sidebar-item" aria-label="Java 向上转型向下转型"><!--[--><!--]--> Java 向上转型向下转型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_call_by_value.html" class="nav-link sidebar-item" aria-label="值传递和引用传递"><!--[--><!--]--> 值传递和引用传递 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_io.html" class="nav-link sidebar-item" aria-label="java 中 IO 流分为几种?"><!--[--><!--]--> java 中 IO 流分为几种? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_jvm_gc.html" class="nav-link sidebar-item" aria-label="GC（Garbage Collector）"><!--[--><!--]--> GC（Garbage Collector） <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_jvm_structure.html" class="nav-link sidebar-item" aria-label="JVM内存结构"><!--[--><!--]--> JVM内存结构 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog/java/java_jvm_dump.html" class="nav-link sidebar-item" aria-label="JVM问题排查"><!--[--><!--]--> JVM问题排查 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="spring base循环依赖"><!--[--><!--]--> spring base循环依赖 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html#一、依赖注入的类型" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="一、依赖注入的类型"><!--[--><!--]--> 一、依赖注入的类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html#二、基于setter的依赖注入" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="二、基于Setter的依赖注入"><!--[--><!--]--> 二、基于Setter的依赖注入 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html#三、基于属性的依赖注入" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="三、基于属性的依赖注入"><!--[--><!--]--> 三、基于属性的依赖注入 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html#四、基于字段的依赖注入缺陷" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="四、基于字段的依赖注入缺陷"><!--[--><!--]--> 四、基于字段的依赖注入缺陷 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html#五、业务无法避免-如何解耦" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="五、业务无法避免，如何解耦"><!--[--><!--]--> 五、业务无法避免，如何解耦 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/java_spring_bean_dependent.html#六、总结" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="六、总结"><!--[--><!--]--> 六、总结 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/blog/java/guava_bloomFilter.html" class="nav-link sidebar-item" aria-label="布隆过滤器"><!--[--><!--]--> 布隆过滤器 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="spring-base循环依赖" tabindex="-1"><a class="header-anchor" href="#spring-base循环依赖" aria-hidden="true">#</a> spring base循环依赖</h1><p>最近在处理项目中Bean循环依赖导致的启动报错问题，发现一些service层的类像一个大胖子，依赖了大量不同模块的service，错综复杂的依赖关系，Spring 的 Bean 懒加载机制都无法解决好这个问题，随着时间的推移，问题越发严重，迭代发布时启动项目时而失败。接下来只能重新梳理业务逻辑，根据 6 大设计原则中的单一职责原则，对项目进行拆分、改造，从根源上解决问题。</p><p>spring 依赖注入官方文档，Spring官方已不推荐使用Autowired字段/属性注入Bean，改为推荐构造器注入和setter注入。</p><h2 id="一、依赖注入的类型" tabindex="-1"><a class="header-anchor" href="#一、依赖注入的类型" aria-hidden="true">#</a> 一、依赖注入的类型</h2><p>尽管针对spring framerwork 5.1.3的文档只定义了两种主要的依赖注入类型，但实际上有三种：</p><p>基于构造函数的依赖注入 基于setter的依赖注入 基于字段的依赖注入</p><p>其中基于字段的依赖注入被广泛使用，但是idea或者其他静态代码分析工具会给出提示信息，不推荐使用。</p><p>@Component public class FormPlatformServiceImpl {</p><p>private final RolesManageDao rolesManageDao;</p><p>@Autowired     public FormPlatformServiceImpl(RolesManageDao rolesManageDao) {         this.rolesManageDao = rolesManageDao;     } } 然后在spring官方文档中，@Autowired注解也是可以省去的。</p><p>public class SimpleMovieLister {</p><p>// the SimpleMovieLister has a dependency on a MovieFinder     private MovieFinder movieFinder;</p><p>// a constructor so that the Spring container can inject a MovieFinder     public SimpleMovieLister(MovieFinder movieFinder) {         this.movieFinder = movieFinder;     }</p><p>// business logic that actually uses the injected MovieFinder is omitted... } 基于构造函数注入的主要优点是可以将需要注入的字段声明为final， 使得它们会在类实例化期间被初始化，这对于所需的依赖项很方便。</p><h2 id="二、基于setter的依赖注入" tabindex="-1"><a class="header-anchor" href="#二、基于setter的依赖注入" aria-hidden="true">#</a> 二、基于Setter的依赖注入</h2><p>在基于setter的依赖注入中，setter方法被标注为@Autowired。</p><p>一旦使用无参数构造函数或无参数静态工厂方法实例化Bean，为了注入Bean的依赖项，Spring容器将调用这些setter方法。</p><p>@Component public class FormPlatformServiceImpl {</p><p>private RolesManageDao rolesManageDao;</p><p>@Autowired     public void setRolesManageDao(RolesManageDao rolesManageDao) {         this.rolesManageDao = rolesManageDao;     } } 和基于构造器的依赖注入一样，在官方文档中，基于Setter的依赖注入中的@Autowired也可以省去。</p><p>public class SimpleMovieLister {</p><p>// the SimpleMovieLister has a dependency on the MovieFinder     private MovieFinder movieFinder;</p><p>// a setter method so that the Spring container can inject a MovieFinder     public void setMovieFinder(MovieFinder movieFinder) {         this.movieFinder = movieFinder;     }</p><p>// business logic that actually uses the injected MovieFinder is omitted... }</p><h2 id="三、基于属性的依赖注入" tabindex="-1"><a class="header-anchor" href="#三、基于属性的依赖注入" aria-hidden="true">#</a> 三、基于属性的依赖注入</h2><p>在基于属性的依赖注入中，字段/属性被标注为@Autowired。一旦类被实例化，Spring容器将设置这些字段。</p><p>@Service public class FormPlatformServiceImpl {     @Autowired private MemberInfoDao memberInfoDao; } 正如所看到的，这是依赖注入最干净的方法，因为它避免了添加样板代码，并且不需要声明类的构造函数。</p><p>代码看起来很干净简洁，但是正如代码检查器已经向我们暗示的那样，这种方法有一些缺点。</p><h2 id="四、基于字段的依赖注入缺陷" tabindex="-1"><a class="header-anchor" href="#四、基于字段的依赖注入缺陷" aria-hidden="true">#</a> 四、基于字段的依赖注入缺陷</h2><p>1、不允许声明不可变域 基于字段的依赖注入在声明为final/immutable的字段上不起作用，因为这些字段必须在类实例化时实例化。</p><p>声明不可变依赖项的唯一方法是使用基于构造器的依赖注入。</p><p>2、容易违反单一职责设计原则 在面向对象的编程中，六大设计原则被广泛应用，用以提高代码的重用性，可读性，可靠性和可维护性；</p><p>单一职责原则，即一个类应该只负责一项职责，这个类提供的所有服务都应该只为它负责的职责服务。</p><p>使用基于字段的依赖注入，高频使用的类随着时间的推移，我们会在类中逐渐添加越来越多的依赖项，我们用着很爽，很容易忽略类中的依赖已经太多了。 但是如果使用基于构造函数的依赖注入，随着越来越多的依赖项被添加到类中，项目在启动中就能发现循环依赖问题。</p><p>有一个有超过6个参数的构造函数是一个明显的信号，表明类已经转变一个大而全的功能合集，需要将类分割成更小、更容易维护的块。</p><p>3、与依赖注入容器紧密耦合 使用基于字段的依赖注入的主要原因是为了避免getter和setter的样板代码或为类创建构造函数。最后，这意味着设置这些字段的唯一方法是通过Spring容器实例化类并使用反射注入它们，否则字段将保持null。</p><p>依赖注入设计模式将类依赖项的创建与类本身分离开来，并将此责任转移到类注入容器，从而允许程序设计解耦，并遵循单一职责和依赖项倒置原则。</p><p>因此，通过自动装配（autowiring）字段来实现的类的解耦，最终会因为再次与类注入容器(在本例中是Spring)耦合而丢失，从而使类在Spring容器之外变得无用。</p><p>这意味着，如果您想在应用程序容器之外使用您的类，例如用于单元测试，您将被迫使用Spring容器来实例化您的类，因为没有其他可能的方法(除了反射)来设置自动装配字段。</p><h2 id="五、业务无法避免-如何解耦" tabindex="-1"><a class="header-anchor" href="#五、业务无法避免-如何解耦" aria-hidden="true">#</a> 五、业务无法避免，如何解耦</h2><p>如果业务比较复杂，或者无法重构，来不及改造，两个bean循环依赖解决方法如下：</p><p>1.采用spring监听模式，进行解耦；</p><img src="/blog/images/java/spring_bean_202304243.png" alt=""><h2 id="六、总结" tabindex="-1"><a class="header-anchor" href="#六、总结" aria-hidden="true">#</a> 六、总结</h2><p>基于字段的注入应该尽可能地避免，因为它有许多缺点，无论它看起来多么优雅。</p><p>推荐的方法是使用基于构造函数依赖注入。</p><p>1.使用@RequiredArgsConstructor注解，可以自动给final标识的字段生成构造函数，看起来更加简洁，如下图：</p><img src="/blog/images/java/spring_bean_202304241.png" alt=""><p>2.当然也可以自己生成相应的构造函数，如下图：</p><img src="/blog/images/java/spring_bean_2023042402.png" alt=""><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://gitee.com/yaomin_java/yaomin.git/edit/main/java/java_spring_bean_dependent.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!----><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: Amin.Yao@gaiaworks.cn">Amin.Yao</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/blog/java/java_jvm_dump.html" class="nav-link" aria-label="JVM问题排查"><!--[--><!--]--> JVM问题排查 <!--[--><!--]--></a></span><span class="next"><a href="/blog/java/guava_bloomFilter.html" class="nav-link" aria-label="布隆过滤器"><!--[--><!--]--> 布隆过滤器 <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/blog/assets/js/runtime~app.c2b0329d.js" defer></script><script src="/blog/assets/js/1812.cd766a42.js" defer></script><script src="/blog/assets/js/app.f50a6895.js" defer></script>
  </body>
</html>
