{"version":3,"file":"6247.app.js","mappings":";;;;;;;;;;;;AAAO;AACP;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;EClBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAsF;AACtF;AACA,CAAmC;AACnC;AACA,iDAAiD,2BAAa;AAC9D;AACA,SAAS,SAAS;AAClB;;;AAGA,6DAAe","sources":["webpack://yaomin/./docs/.vuepress/.temp/pages/shell/database_transfer.html.js","webpack://yaomin/./docs/.vuepress/.temp/pages/shell/database_transfer.html.vue","webpack://yaomin/./docs/.vuepress/.temp/pages/shell/database_transfer.html.vue?a2fb"],"sourcesContent":["export const data = {\n  \"key\": \"v-7486f642\",\n  \"path\": \"/shell/database_transfer.html\",\n  \"title\": \"数据库迁移脚本\",\n  \"lang\": \"zh-CN\",\n  \"frontmatter\": {},\n  \"excerpt\": \"\",\n  \"headers\": [],\n  \"filePathRelative\": \"shell/database_transfer.md\",\n  \"git\": {\n    \"contributors\": [\n      {\n        \"name\": \"Amin.Yao\",\n        \"email\": \"Amin.Yao@gaiaworks.cn\",\n        \"commits\": 1\n      }\n    ]\n  }\n}\n","<h1 id=\"数据库迁移脚本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#数据库迁移脚本\" aria-hidden=\"true\">#</a> 数据库迁移脚本</h1>\n<div class=\"language-bash ext-sh line-numbers-mode\"><pre v-pre class=\"language-bash\"><code><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token function-name function\">check_status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n<span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token builtin class-name\">echo</span> $?<span class=\"token variable\">`</span></span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$status</span> -ne <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"运行异常，退出\"</span>\n<span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function-name function\">check_connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"quit\"</span><span class=\"token operator\">|</span> <span class=\"token function\">timeout</span> 5s telnet <span class=\"token variable\">$1</span> <span class=\"token variable\">$2</span><span class=\"token operator\">|</span><span class=\"token function\">grep</span> -q Escape\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$?</span> -eq <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"数据库端口连接正常\"</span>\n<span class=\"token keyword\">else</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"数据库连接异常，退出！\"</span>\n<span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$#</span> -eq <span class=\"token number\">5</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"开始创建\"</span><span class=\"token variable\">$5</span><span class=\"token string\">\"排班数据库\"</span>\nmysql -h<span class=\"token variable\">$1</span> -P<span class=\"token variable\">$2</span> -u<span class=\"token variable\">$3</span> -p<span class=\"token variable\">$4</span> -e <span class=\"token string\">\"create database <span class=\"token variable\">$5</span> CHARACTER SET utf8 COLLATE utf8_general_ci;\"</span>\ncheck_status\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">${5}</span>排班数据库创建完成\"</span>\n<span class=\"token keyword\">elif</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$#</span> -eq <span class=\"token number\">11</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"开始备份并导入数据库\"</span>\ncheck_connect <span class=\"token variable\">$6</span> <span class=\"token variable\">$7</span>\nmysqldump -h<span class=\"token variable\">$6</span> -P<span class=\"token variable\">$7</span> -u<span class=\"token variable\">$8</span> -p<span class=\"token variable\">$9</span> --set-gtid-purged<span class=\"token operator\">=</span>off --single-transaction <span class=\"token variable\">${10}</span>  -q -R  -E <span class=\"token operator\">|</span> <span class=\"token function\">sed</span>   -e <span class=\"token string\">\"s/DEFINE.*PROCEDURE/PROCEDURE/;s/DEFINE.*FUNCTION/FUNCTION/;s/DEFINER.*DEFINER//;s/DEFINER.*EVENT/EVENT/;s/DEFINER.*VIEW/VIEW/;s/utf8mb4_0900_ai_ci/utf8mb4_general_ci/;s/CHARSET=utf8mb3/CHARSET=utf8/;s/\\<span class=\"token variable\"><span class=\"token variable\">`</span>$<span class=\"token punctuation\">{</span><span class=\"token number\">10</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">\\</span><span class=\"token variable\">`</span></span>.//g\"</span><span class=\"token operator\">></span>/data/<span class=\"token variable\">${11}</span>_dump.sql\ncheck_status\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"备份成功\"</span>\n<span class=\"token comment\">#mysql -h$1 -P$2 -u$3 -p$4 -e 'set sql_log_bin=0'</span>\nmysql -h<span class=\"token variable\">$1</span> -P<span class=\"token variable\">$2</span> -u<span class=\"token variable\">$3</span> -p<span class=\"token variable\">$4</span> -D<span class=\"token string\">\"<span class=\"token variable\">$5</span>\"</span> <span class=\"token operator\">&lt;</span>/data/<span class=\"token variable\">${11}</span>_dump.sql\ncheck_status\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"导库成功\"</span>\n<span class=\"token comment\">#rm -rf /data/${11}_dump.sql</span>\n<span class=\"token keyword\">else</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"参数有误\"</span>\n<span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n</code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br><span class=\"line-number\">10</span><br><span class=\"line-number\">11</span><br><span class=\"line-number\">12</span><br><span class=\"line-number\">13</span><br><span class=\"line-number\">14</span><br><span class=\"line-number\">15</span><br><span class=\"line-number\">16</span><br><span class=\"line-number\">17</span><br><span class=\"line-number\">18</span><br><span class=\"line-number\">19</span><br><span class=\"line-number\">20</span><br><span class=\"line-number\">21</span><br><span class=\"line-number\">22</span><br><span class=\"line-number\">23</span><br><span class=\"line-number\">24</span><br><span class=\"line-number\">25</span><br><span class=\"line-number\">26</span><br><span class=\"line-number\">27</span><br><span class=\"line-number\">28</span><br><span class=\"line-number\">29</span><br><span class=\"line-number\">30</span><br><span class=\"line-number\">31</span><br><span class=\"line-number\">32</span><br><span class=\"line-number\">33</span><br><span class=\"line-number\">34</span><br><span class=\"line-number\">35</span><br><span class=\"line-number\">36</span><br><span class=\"line-number\">37</span><br></div></div>","import { ssrRender } from \"./database_transfer.html.vue?vue&type=template&id=eaef2abe\"\nconst script = {}\nimport { ssrContextKey } from 'vue'\nscript.ssrRender = (...args) => {\n  const ssrContext = args[2].appContext.provides[ssrContextKey]\n  ssrContext._registeredComponents.add(\"D:\\\\yaomin\\\\WorkSpace\\\\yaomin_java2\\\\node_modules\\\\@vuepress\\\\bundler-webpack\\\\lib\\\\build\\\\ssr\\\\vuepressLoader.js!D:\\\\yaomin\\\\WorkSpace\\\\yaomin_java2\\\\node_modules\\\\vue-loader\\\\dist\\\\index.js??ruleSet[0].use[1]!D:\\\\yaomin\\\\WorkSpace\\\\yaomin_java2\\\\docs\\\\.vuepress\\\\.temp\\\\pages\\\\shell\\\\database_transfer.html.vue\")\n  return ssrRender(...args)\n}\n\n\nexport default script"],"names":[],"sourceRoot":""}